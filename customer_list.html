<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>B2B CRM 고객 목록</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
  <style>
    body { font-family: 'Pretendard', sans-serif; }
  </style>
</head>

<body class="bg-gray-50 h-screen flex overflow-hidden">
  <!-- ✅ 좌측 사이드 메뉴 (공통) -->
  <aside class="w-[230px] bg-blue-800 text-white flex-shrink-0">
    <a href="b2b_dashboard_tailwind.html" class="block p-5 text-lg font-semibold border-b border-blue-700 hover:bg-blue-700 transition">
      B2B CRM 메뉴
    </a>

    <nav class="p-3 space-y-2">
      <!-- 문자관리 -->
      <div>
        <button id="menuToggle1" class="w-full flex justify-between items-center px-4 py-2 rounded-lg hover:bg-blue-700 transition">
          <span>문자관리</span>
          <span>▼</span>
        </button>
        <div id="menu1" class="hidden ml-4 mt-2 space-y-1 text-sm">
          <a href="#" onclick="alert('챔프B2B운영자(최고운영자)로 이동합니다.')" class="block px-3 py-1 hover:bg-blue-700 rounded">문자발송</a>
          <a href="#" onclick="alert('챔프B2B운영자(최고운영자)로 이동합니다.')" class="block px-3 py-1 hover:bg-blue-700 rounded">문자설정</a>
          <a href="#" onclick="alert('챔프B2B운영자(최고운영자)로 이동합니다.')" class="block px-3 py-1 hover:bg-blue-700 rounded">발송이력 조회</a>
        </div>
      </div>

      <!-- 이메일 관리 -->
      <div>
        <button id="menuToggleEmail" class="w-full flex justify-between items-center px-4 py-2 rounded-lg hover:bg-blue-700 transition">
          <span>이메일 관리</span>
          <span>▼</span>
        </button>
        <div id="menuEmail" class="hidden ml-4 mt-2 space-y-1 text-sm">
          <a href="#" class="block px-3 py-1 hover:bg-blue-700 rounded">웹메일(Biz)</a>
          <a href="#" class="block px-3 py-1 hover:bg-blue-700 rounded">패스메일(fnBiz)</a>
        </div>
      </div>

      <!-- 비즈톡 관리 -->
      <div>
        <button id="menuToggleBiztalk" class="w-full flex justify-between items-center px-4 py-2 rounded-lg hover:bg-blue-700 transition">
          <span>비즈톡 관리</span>
          <span>▼</span>
        </button>
        <div id="menuBiztalk" class="hidden ml-4 mt-2 space-y-1 text-sm">
          <a href="#" onclick="alert('챔프B2B운영자(최고운영자)로 이동합니다.')" class="block px-3 py-1 hover:bg-blue-700 rounded">비즈톡발송(강의)</a>
          <a href="#" onclick="alert('챔프B2B운영자(최고운영자)로 이동합니다.')" class="block px-3 py-1 hover:bg-blue-700 rounded">비즈톡발송(회원)</a>
          <a href="#" onclick="alert('챔프B2B운영자(최고운영자)로 이동합니다.')" class="block px-3 py-1 hover:bg-blue-700 rounded">발송이력 조회(강의)</a>
          <a href="#" onclick="alert('챔프B2B운영자(최고운영자)로 이동합니다.')" class="block px-3 py-1 hover:bg-blue-700 rounded">발송이력 조회(회원)</a>
        </div>
      </div>

      <!-- 관리메뉴 -->
      <div>
        <button id="menuToggle2" class="w-full flex justify-between items-center px-4 py-2 rounded-lg hover:bg-blue-700 transition">
          <span>관리메뉴</span>
          <span>▼</span>
        </button>
        <div id="menu2" class="ml-4 mt-2 space-y-1 text-sm">
          <a href="b2b_dashboard_tailwind.html" class="block px-3 py-1 hover:bg-blue-700 rounded">상담 현황</a>
          <a href="company_list.html" class="block px-3 py-1 hover:bg-blue-700 rounded">기업 목록</a>
          <a href="customer_list.html" class="block px-3 py-1 bg-blue-900 rounded font-semibold">고객 목록</a>
          <a href="#" onclick="alert('챔프B2B운영자(최고운영자)로 이동합니다.')" class="block px-3 py-1 hover:bg-blue-700 rounded">수강시간 조회</a>
          <a href="#" onclick="alert('챔프B2B운영자(최고운영자)로 이동합니다.')" class="block px-3 py-1 hover:bg-blue-700 rounded">학습상담·CS 관리</a>
          <a href="manual_list.html" class="block px-3 py-1 hover:bg-blue-700 rounded">메뉴얼 관리</a>
          <a href="customer_search_registration.html" class="block px-3 py-1 hover:bg-blue-700 rounded">고객 검색/등록</a>
        </div>
      </div>
    </nav>
  </aside>

  <!-- ✅ 메인 영역 -->
  <div class="flex-1 flex flex-col">
    <!-- 상단 헤더 -->
    <header class="bg-blue-700 text-white py-4 shadow">
      <div class="w-full px-10 flex justify-between items-center">
        <h1 class="text-2xl font-semibold">고객 목록</h1>
        <span class="text-sm opacity-90">관리자용</span>
      </div>
    </header>

    <main class="flex-1 w-full px-10 py-8 overflow-y-auto">
      <!-- 테이블 영역 -->
      <section class="bg-white p-6 rounded-xl shadow overflow-x-auto">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-lg font-semibold text-gray-800">전체 고객</h2>
          <div class="flex items-center space-x-4">
            <button onclick="alert('엑셀 파일 일괄 등록 기능이 실행됩니다.')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition text-sm font-semibold">
              Excel파일 일괄등록
            </button>
            <button onclick="window.location.href='customer_search_registration.html'" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition text-sm font-semibold">
              신규 고객 등록
            </button>
            <span id="count" class="text-sm text-gray-500"></span>
          </div>
        </div>

        <table class="w-full table-auto border-collapse text-sm text-gray-700">
          <thead>
            <tr class="bg-gray-100 border-b text-left text-gray-600">
              <th class="p-4">기업코드</th>
              <th class="p-4">회사명</th>
              <th class="p-4">아이디</th>
              <th class="p-4">이름</th>
              <th class="p-4">회원구분</th>
              <th class="p-4">email</th>
              <th class="p-4">핸드폰</th>
              <th class="p-4">전화번호</th>
              <th class="p-4">회원가입일</th>
              <th class="p-4">회원정보</th>
              <th class="p-4">배송지 정보</th>
              <th class="p-4">사이트 이동</th>
            </tr>
          </thead>
          <tbody id="table-body"></tbody>
        </table>

        <div class="mt-6 flex justify-center">
            <button id="load-more" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-300 transition font-semibold">
                더보기
            </button>
        </div>
      </section>
    </main>
  </div>

  <script>
    // ✅ 사이드메뉴 토글
    const menuToggle1 = document.getElementById("menuToggle1");
    const menu1 = document.getElementById("menu1");
    const menuToggle2 = document.getElementById("menuToggle2");
    const menu2 = document.getElementById("menu2");
    const menuToggleEmail = document.getElementById("menuToggleEmail");
    const menuEmail = document.getElementById("menuEmail");
    const menuToggleBiztalk = document.getElementById("menuToggleBiztalk");
    const menuBiztalk = document.getElementById("menuBiztalk");

    menuToggle1.addEventListener("click", () => menu1.classList.toggle("hidden"));
    menuToggle2.addEventListener("click", () => menu2.classList.toggle("hidden"));
    menuToggleEmail.addEventListener("click", () => menuEmail.classList.toggle("hidden"));
    menuToggleBiztalk.addEventListener("click", () => menuBiztalk.classList.toggle("hidden"));
    menu2.classList.remove("hidden"); // 관리메뉴는 기본으로 열어둠

    // ✅ 고객 목록 더미 데이터 (30개)
    const companies = [
        { name: "삼성전자", code: "samsung" },
        { name: "SK하이닉스", code: "skhynix" },
        { name: "LG화학", code: "lgchem" },
        { name: "현대자동차", code: "hyundai" },
        { name: "카카오", code: "kakao" },
        { name: "네이버", code: "naver" },
        { name: "CJ푸드빌", code: "cjfood" },
        { name: "대한항공", code: "koreanair" },
        { name: "다우오피스", code: "daou" },
        { name: "포스코", code: "posco" }
    ];

    const dummyCustomers = [];
    companies.forEach((company, companyIndex) => {
      for (let i = 0; i < 3; i++) {
        const firstNames = ["김", "이", "박", "최", "정", "강", "조", "윤", "장", "임"];
        const lastNames = ["민준", "서연", "도윤", "서윤", "시우", "지우", "하준", "지유", "주원", "서현"];
        const memberTypes = ["학습자", "기업관리자", "교육담당자", "기업운영자"];
        const name = firstNames[(companyIndex + i) % firstNames.length] + lastNames[(companyIndex + i) % lastNames.length];
        const id = `${company.code}_user${i + 1}`;
        dummyCustomers.push({
            companyCode: company.code,
            companyName: company.name,
            id: id,
            name: name,
            memberType: memberTypes[i % memberTypes.length],
            email: `${id}@${company.code}.com`,
            mobilePhone: `010-****-${String(Math.floor(Math.random() * 9000) + 1000)}`,
            officePhone: `02-****-${String(Math.floor(Math.random() * 9000) + 1000)}`,
            regDate: `2025-10-${String(20 - (companyIndex + i)).padStart(2, '0')}`
        });
      }
    });

    const tbody = document.getElementById("table-body");
    const loadMoreBtn = document.getElementById("load-more");
    const itemsPerPage = 10;
    let itemsShown = 0;

    // ✅ 전화번호 마스킹 함수
    function maskPhoneNumber(phone) {
      if (!phone || typeof phone !== 'string') {
        return '';
      }
      const parts = phone.split('-');
      if (parts.length === 3) {
        parts[1] = '****';
        return parts.join('-');
      }
      return phone;
    }

    function renderTable() {
        const toShow = dummyCustomers.slice(itemsShown, itemsShown + itemsPerPage);

        toShow.forEach((d) => {
            const row = document.createElement("tr");
            row.className = "border-b hover:bg-blue-50 transition";
            row.innerHTML = `
                <td class='p-4'>${d.companyCode}</td>
                <td class='p-4 font-medium'>${d.companyName}</td>
                <td class='p-4'>${d.id}</td>
                <td class='p-4'>${d.name}</td>
                <td class='p-4'>${d.memberType}</td>
                <td class='p-4'>${d.email}</td>
                <td class='p-4'>${maskPhoneNumber(d.mobilePhone)}</td>
                <td class='p-4'>${maskPhoneNumber(d.officePhone)}</td>
                <td class='p-4'>${d.regDate}</td>
                <td class='p-4'><button onclick="alert('회원정보 수정 페이지로 이동합니다.')" class="bg-gray-200 text-gray-700 px-3 py-1 rounded text-xs hover:bg-gray-300">수정</button></td>
                <td class='p-4'><button onclick="alert('배송지 정보 수정 페이지로 이동합니다.')" class="bg-gray-200 text-gray-700 px-3 py-1 rounded text-xs hover:bg-gray-300">수정</button></td>
                <td class='p-4'><button onclick="alert('${d.companyName} 사이트로 이동합니다.')" class="bg-blue-100 text-blue-700 px-3 py-1 rounded text-xs hover:bg-blue-200">이동</button></td>
                `;
            tbody.appendChild(row);
        });

        itemsShown += toShow.length;

        if (itemsShown >= dummyCustomers.length) {
            loadMoreBtn.style.display = 'none';
        }
    }

    loadMoreBtn.addEventListener('click', renderTable);

    // 초기 데이터 로드
    renderTable();
    document.getElementById("count").innerText = `총 ${dummyCustomers.length}건`;

  </script>
</body>

</html>