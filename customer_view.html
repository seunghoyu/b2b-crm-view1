<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>B2B CRM ê³ ê°ì¡°íšŒ</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-blue-50 flex min-h-screen">
  <!-- âœ… ì¢Œì¸¡ ì‚¬ì´ë“œ ë©”ë‰´ -->
  <aside class="w-56 bg-blue-800 text-white flex-shrink-0 fixed h-screen top-0 left-0">
    <div class="p-5 text-lg font-semibold border-b border-blue-700">
      ê¸°ëŠ¥ ë©”ë‰´
    </div>

    <nav class="p-3 space-y-2">
      <div>
        <button id="menuUserInfo" class="w-full text-left px-4 py-2 rounded-lg hover:bg-blue-700 transition">
          íšŒì› ì •ë³´
        </button>
      </div>

      <div>
        <button id="menuDeliveryInfo" class="w-full text-left px-4 py-2 rounded-lg hover:bg-blue-700 transition">
          ë°°ì†¡ì§€ ì •ë³´
        </button>
      </div>

      <div>
        <button id="menuAdminSite" class="w-full text-left px-4 py-2 rounded-lg hover:bg-blue-700 transition">
          ì‚¬ì´íŠ¸ ì´ë™ [ê´€ë¦¬ì]
        </button>
      </div>

      <div>
        <button id="menuUserSite" class="w-full text-left px-4 py-2 rounded-lg hover:bg-blue-700 transition">
          ì‚¬ì´íŠ¸ ì´ë™ [í•™ìŠµì]
        </button>
      </div>
    </nav>
  </aside>

  <!-- âœ… ë³¸ë¬¸ ì „ì²´ -->
  <div class="flex-1 flex flex-col ml-56">
    <!-- âœ… ìƒë‹¨: ê³ ê°ì •ë³´ + ì‘ëŒ€ì…ë ¥ -->
    <header class="sticky top-0 bg-white shadow p-5 flex justify-between items-start z-10">
      <div class="w-1/2">
        <h2 class="text-lg font-semibold">
          ìƒë‹´ ê±´: LGí™”í•™ (2025-09-25 17:30:56)
        </h2>
        <p class="text-sm text-gray-500 mb-2">ìƒë‹´ì: í™ê¸¸ë™ (ì˜ì—…íŒ€)</p>
        <table class="table-auto text-sm border-collapse w-full text-gray-700">
          <tbody>
            <tr class="border-b">
              <td class="p-2 font-semibold w-32">ì•„ì´ë””</td>
              <td class="p-2">lgchem01</td>
              <td class="p-2 font-semibold w-32">ì´ë¦„</td>
              <td class="p-2">ê¹€í•´ì»¤</td>
            </tr>
            <tr class="border-b">
              <td class="p-2 font-semibold">êµ¬ë¶„</td>
              <td class="p-2">ê¸°ì—…ê´€ë¦¬ì</td>
              <td class="p-2 font-semibold">ì§ì±…</td>
              <td class="p-2">íŒ€ì¥</td>
            </tr>
            <tr>
              <td class="p-2 font-semibold">ì—°ë½ì²˜</td>
              <td class="p-2">010-1234-5678</td>
              <td class="p-2 font-semibold">ì˜ì—…ë‹´ë‹¹ì</td>
              <td class="p-2">ë°•ì§€í˜„</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="w-1/2 flex flex-col items-end">
        <div class="flex space-x-2 mb-3 flex-wrap gap-y-2">
          <select class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-blue-400">
            <option>í™ê¸¸ë™</option>
            <option>ì´í˜„ìš°</option>
            <option>ë°•ì§€í˜„</option>
          </select>
          <select id="categoryMain" class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-blue-400">
            <option value="">ëŒ€ë¶„ë¥˜ ì„ íƒ</option>
            <option value="ìˆ˜ê°•Â·ê²°ì œ">ìˆ˜ê°•Â·ê²°ì œ</option>
            <option value="ìˆ˜ê°•í™˜ê²½Â·ì ‘ì†">ìˆ˜ê°•í™˜ê²½Â·ì ‘ì†</option>
            <option value="í•™ìŠµì§„í–‰Â·í‰ê°€">í•™ìŠµì§„í–‰Â·í‰ê°€</option>
            <option value="ê°•ì˜Â·ê°•ì‚¬">ê°•ì˜Â·ê°•ì‚¬</option>
            <option value="ê¸°íƒ€Â·ì œíœ´">ê¸°íƒ€Â·ì œíœ´</option>
          </select>
          <select id="categorySub" class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-blue-400 disabled:bg-gray-100 disabled:cursor-not-allowed" disabled>
            <option value="">ì¤‘ë¶„ë¥˜ ì„ íƒ</option>
          </select>
          <input type="text" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
            class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-blue-400 w-[250px]" />
        </div>
        <div class="flex w-full justify-end">
          <textarea placeholder="ì‘ëŒ€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."
            class="border border-gray-350 rounded-l-lg px-3 py-2 w-[600px] h-24 focus:ring-blue-400 focus:outline-none"></textarea>
          <button class="bg-blue-600 text-white px-5 py-2 rounded-r-lg hover:bg-blue-700 transition">
            ì €ì¥
          </button>
        </div>
      </div>
    </header>

    <main class="flex-1 overflow-y-auto p-6 space-y-8">
      <!-- âœ… ìƒë‹´ì´ë ¥ -->
      <section class="bg-white rounded-xl shadow p-5 flex space-x-6 h-[500px]">
        <!-- âœ… ì¢Œì¸¡: ìƒë‹´ ëª©ë¡ -->
        <div class="w-1/2 flex flex-col">
          <h3 class="font-semibold text-lg mb-3 text-blue-700">ìƒë‹´ì´ë ¥</h3>
          <div class="overflow-x-auto overflow-y-auto flex-1">
            <table class="w-full text-sm border-collapse table-auto">
              <thead class="bg-blue-100 text-gray-700">
                <tr>
                  <th class="p-3">ìƒë‹´ì¼ì‹œ</th>
                  <th class="p-3">ìƒë‹´ì±„ë„</th>
                  <th class="p-3">ì œëª©</th>
                  <th class="p-3">ì§„í–‰ìƒíƒœ</th>
                  <th class="p-3">ë‹´ë‹¹ì</th>
                </tr>
              </thead>
              <tbody id="history-body"></tbody>
            </table>
          </div>
          <button id="history-more"
            class="hidden mt-3 bg-blue-100 text-blue-600 px-3 py-1 rounded hover:bg-blue-200 text-sm">
            ë”ë³´ê¸°
          </button>
        </div>

        <!-- âœ… ìš°ì¸¡: ìƒë‹´ ìƒì„¸ë³´ê¸° -->
        <div id="history-detail"
          class="w-1/2 hidden bg-blue-50 rounded-lg p-4 border border-blue-200 overflow-y-auto">
          <p class="text-gray-500 text-sm text-center">ìƒë‹´ ë‚´ì—­ì„ ì„ íƒí•˜ì„¸ìš”.</p>
        </div>
      </section>



      <!-- âœ… í•™ìŠµê´€ë¦¬ -->
      <section class="bg-white rounded-xl shadow p-5 flex flex-col max-h-[500px]">
        <h3 class="font-semibold text-lg mb-3 text-blue-700">í•™ìŠµê´€ë¦¬</h3>

        <div class="overflow-x-auto overflow-y-auto flex-1">
          <table class="w-full text-sm border-collapse table-auto">
            <thead class="bg-blue-100 text-gray-700">
              <tr>
                <th class="p-3">í•™ìŠµì°¨ìˆ˜</th>
                <th class="p-3">ê°•ì˜ì½”ë“œ</th>
                <th class="p-3">ê°•ì˜ëª…</th>
                <th class="p-3">êµìœ¡ê¸°ê°„</th>
                <th class="p-3">ë³µìŠµê¸°ê°„</th>
                <th class="p-3">ì¶œì„ë¥ </th>
                <th class="p-3">ì¶œì„ì ìˆ˜</th>
                <th class="p-3">ì‹œí—˜ì ìˆ˜</th>
                <th class="p-3">ëª¨ì˜ê³ ì‚¬ ì ìˆ˜</th>
                <th class="p-3">ë ˆë²¨ì ìˆ˜</th>
                <th class="p-3">ë“±ê¸‰</th>
                <th class="p-3">ìˆ˜ë£Œì—¬ë¶€</th>
                <th class="p-3">ê¸°ì¤€ìˆ˜ë£Œì ìˆ˜</th>
                <th class="p-3">ê°•ì˜ì œê³µì—…ì²´</th>
                <th class="p-3">ë“±ë¡ì¼</th>
              </tr>
            </thead>
            <tbody id="study-body"></tbody>
          </table>
        </div>

        <p id="study-empty" class="hidden text-gray-500 text-sm mt-4 text-center">
          ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.
        </p>

        <button id="study-more"
          class="hidden mt-3 bg-blue-100 text-blue-600 px-3 py-1 rounded hover:bg-blue-200 text-sm">
          ë”ë³´ê¸°
        </button>
      </section>




      <!-- âœ… ë°°ì†¡ê´€ë¦¬ -->
      <section class="bg-white rounded-xl shadow p-5 flex flex-col max-h-[500px]">
        <h3 class="font-semibold text-lg mb-3 text-blue-700">ë°°ì†¡ê´€ë¦¬</h3>

        <!-- âœ… ê°€ë¡œ ìŠ¤í¬ë¡¤ ê°ì‹¸ê¸° -->
        <div class="overflow-x-auto overflow-y-auto flex-1">
          <table class="w-full text-sm border-collapse table-auto">
            <thead class="bg-blue-100 text-gray-700">
              <tr>
                <th class="p-3">ì£¼ë¬¸ì¼</th>
                <th class="p-3">ì£¼ë¬¸ë²ˆí˜¸</th>
                <th class="p-3">êµì¬ëª…</th>
                <th class="p-3">ì£¼ë¬¸ì•¡</th>
                <th class="p-3">ì„œì  ì£¼ë¬¸ë²ˆí˜¸</th>
                <th class="p-3">íƒë°°ì‚¬</th>
                <th class="p-3">ì†¡ì¥ë²ˆí˜¸</th>
                <th class="p-3">ì£¼ë¬¸ìƒíƒœ</th>
                <th class="p-3">ê²°ì œì¼</th>
                <th class="p-3">ë°°ì†¡ë°©ë²•</th>
              </tr>
            </thead>
            <tbody id="delivery-body"></tbody>
          </table>
        </div>

        <!-- âœ… ë°ì´í„° ì—†ì„ ë•Œ í‘œì‹œ -->
        <p id="delivery-empty" class="hidden text-gray-500 text-sm mt-4 text-center">
          ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.
        </p>

        <button id="delivery-more"
          class="hidden mt-3 bg-blue-100 text-blue-600 px-3 py-1 rounded hover:bg-blue-200 text-sm">
          ë”ë³´ê¸°
        </button>
      </section>


      <!-- âœ… ëª¨ë‹¬ êµ¬ì¡° -->
      <div id="modalOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
        <div class="bg-white rounded-xl shadow-2xl w-[750px] max-h-[80vh] overflow-y-auto p-6 relative border-4 border-blue-300">
          <h3 id="modalTitle" class="text-2xl font-bold text-blue-700 mb-4 pb-2 border-b-2 border-blue-200">
            ì •ë³´ ë³´ê¸°
          </h3>
          <div id="modalContent" class="text-sm text-gray-700"></div>
          <div class="flex justify-end mt-6 space-x-3">
            <button id="saveBtn" class="hidden bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700 transition font-semibold shadow-md">
              ì €ì¥í•˜ê¸°
            </button>
            <button id="closeBtn" class="bg-gray-400 text-white px-5 py-2 rounded-lg hover:bg-gray-500 transition font-semibold shadow-md">
              ë‹«ê¸°
            </button>
          </div>
        </div>
      </div>

      <script>
        // ğŸ”¹ ëŒ€ë¶„ë¥˜-ì¤‘ë¶„ë¥˜ ì—°ë™ ê¸°ëŠ¥
        const categoryMap = {
          "ìˆ˜ê°•Â·ê²°ì œ": ["ê²°ì œì˜¤ë¥˜", "í™˜ë¶ˆë¬¸ì˜", "ì˜ìˆ˜ì¦ë°œê¸‰", "í• ì¸ë¬¸ì˜", "ê²°ì œë°©ë²•"],
          "ìˆ˜ê°•í™˜ê²½Â·ì ‘ì†": ["ë¡œê·¸ì¸ë¬¸ì œ", "ë¹„ë°€ë²ˆí˜¸ì°¾ê¸°", "ê³„ì •ì˜¤ë¥˜", "ì ‘ì†ë¶ˆê°€", "ë¸Œë¼ìš°ì €ë¬¸ì œ"],
          "í•™ìŠµì§„í–‰Â·í‰ê°€": ["ì§„ë„ìœ¨ë¬¸ì˜", "ì‹œí—˜ì‘ì‹œ", "ê³¼ì œì œì¶œ", "ìˆ˜ë£Œì¦ë°œê¸‰", "ì„±ì ë¬¸ì˜"],
          "ê°•ì˜Â·ê°•ì‚¬": ["ê°•ì‚¬í‰ê°€", "ê°•ì˜ë‚´ìš©", "ê°•ì˜ìë£Œ", "ê°•ì˜ì˜¤ë¥˜", "ê°•ì˜ìš”ì²­"],
          "ê¸°íƒ€Â·ì œíœ´": ["ì œíœ´ë¬¸ì˜", "ê²¬ì ë¬¸ì˜", "ë‹¨ì²´ë¬¸ì˜", "ê¸°íƒ€", "ê±´ì˜ì‚¬í•­"]
        };

        const categoryMainSelect = document.getElementById("categoryMain");
        const categorySubSelect = document.getElementById("categorySub");

        // ëŒ€ë¶„ë¥˜ ì„ íƒ ì‹œ ì¤‘ë¶„ë¥˜ ì—…ë°ì´íŠ¸
        categoryMainSelect.addEventListener("change", function() {
          const selectedMain = this.value;
          categorySubSelect.innerHTML = '<option value="">ì¤‘ë¶„ë¥˜ ì„ íƒ</option>';
          
          if (selectedMain && categoryMap[selectedMain]) {
            categoryMap[selectedMain].forEach(sub => {
              const option = document.createElement("option");
              option.value = sub;
              option.textContent = sub;
              categorySubSelect.appendChild(option);
            });
            categorySubSelect.disabled = false;
          } else {
            categorySubSelect.disabled = true;
          }
        });

        // 1ï¸âƒ£ --- ë”ë¯¸ë°ì´í„° (ë§¨ ìœ„ë¡œ ì´ë™í•´ì•¼ í•¨) ---
        
        // âœ… íšŒì› ì •ë³´ ë”ë¯¸ ë°ì´í„°
        const memberData = {
          "ì•„ì´ë””": "lgchem01",
          "ì´ë¦„": "ê¹€í•´ì»¤",
          "ìƒë…„ì›”ì¼": "1985-03-15",
          "ì„±ë³„": "ë‚¨",
          "ì´ë©”ì¼": "kim.hacker@lgchem.com",
          "íœ´ëŒ€í°": "010-1234-5678",
          "ì „í™”ë²ˆí˜¸": "02-3773-1234",
          "íšŒì‚¬ëª…": "LGí™”í•™",
          "ë¶€ì„œ": "ì•ˆì „íŒ€",
          "ì§ì±…": "íŒ€ì¥",
          "ì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 231",
          "ê°€ì…ì¼": "2023-01-10",
          "ìµœê·¼ì ‘ì†ì¼": "2025-09-25 17:30:56"
        };

        // âœ… ë°°ì†¡ì§€ ì •ë³´ ë”ë¯¸ ë°ì´í„°
        const deliveryData = {
          "ë°›ëŠ”ì‚¬ëŒ": "ê¹€í•´ì»¤",
          "ì—°ë½ì²˜": "010-1234-5678",
          "ìš°í¸ë²ˆí˜¸": "06142",
          "ì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 231",
          "ìƒì„¸ì£¼ì†Œ": "LGí™”í•™ ë³¸ì‚¬ ë¹Œë”© 5ì¸µ",
          "ë°°ì†¡ìš”ì²­ì‚¬í•­": "ë¶€ì¬ ì‹œ ê²½ë¹„ì‹¤ì— ë§¡ê²¨ì£¼ì„¸ìš”",
          "ê¸°ë³¸ë°°ì†¡ì§€": "ì˜ˆ"
        };
        
        const historyData = Array.from({ length: 10 }, (_, i) => ({
          channel: i % 2 === 0 ? "1:1 ë¬¸ì˜ê²Œì‹œíŒ" : "ì „í™”ìƒë‹´",
          categoryMain: ["ìˆ˜ê°•Â·ê²°ì œ", "ìˆ˜ê°•í™˜ê²½Â·ì ‘ì†", "í•™ìŠµì§„í–‰Â·í‰ê°€", "ê°•ì˜Â·ê°•ì‚¬", "ê¸°íƒ€Â·ì œíœ´"][i % 5],
          categorySub: ["ê²°ì œì˜¤ë¥˜", "ë¡œê·¸ì¸ë¬¸ì œ", "ì§„ë„ìœ¨ë¬¸ì˜", "ê°•ì‚¬í‰ê°€", "ì œíœ´ë¬¸ì˜"][i % 5],
          date: `2025-09-${String(10 + i).padStart(2, '0')}`,
          datetime: `2025-09-${String(10 + i).padStart(2, '0')} ${String(14 + i).padStart(2, '0')}:${String(20 + (i * 3) % 60).padStart(2, '0')}`,
          title: `ìƒë‹´ í…ŒìŠ¤íŠ¸ ${i + 1}`,
          status: i % 2 === 0 ? "ì²˜ë¦¬ì™„ë£Œ" : "ì²˜ë¦¬ëŒ€ê¸°",
          manager: ["í™ê¸¸ë™", "ì´í˜„ìš°", "ë°•ì§€í˜„"][i % 3],
          detail: {
            reply: i === 0 ? "ì•ˆë…•í•˜ì„¸ìš”. ìƒë‹´ í…ŒìŠ¤íŠ¸ 1ë²ˆì˜ ë‹µë³€ ë‚´ìš©ì…ë‹ˆë‹¤.\në¬¸ì˜ì£¼ì‹  ê²°ì œ ì˜¤ë¥˜ëŠ” í˜„ì¬ ì •ìƒ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.\nì•„ë˜ ê²°ì œì˜¤ë¥˜ í•´ê²°í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.\nB2Bê´€ë¦¬ìë‹¨ > ìˆ˜ê°•ê²°ì œë‚´ì—­ > ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰í•˜ì—¬ ì·¨ì†Œ" : "",
          },
        })).sort((a, b) => new Date(b.datetime) - new Date(a.datetime));

        const studyData = Array.from({ length: 10 }, (_, i) => ({
          round: `2025${10 + i}`,
          code: `LGC${100 + i}`,
          subject: `ì‚°ì—…ì•ˆì „êµìœ¡ ${i + 1}`,
          period: `2025-09-${1 + i} ~ 2025-09-${10 + i}`,
          reviewPeriod: `2025-10-${1 + i} ~ 2025-10-${10 + i}`,
          attend: `${80 + i}%`,
          test: `${70 + i}%`,
          mock: `${75 + i}%`,
          reset: i % 3,
          level: i + 1,
          grade: ["A", "B", "C"][i % 3],
          complete: i % 2 === 0 ? "ìˆ˜ë£Œ" : "ë¯¸ìˆ˜ë£Œ",
          baseScore: 80,
          provider: "í•´ì»¤ìŠ¤",
          regDate: `2025-09-${15 + i}`,
        })).sort((a, b) => parseInt(b.round) - parseInt(a.round));

        const newDeliveryData = Array.from({ length: 10 }, (_, i) => ({
          orderDate: `2025-09-${String(10 + i).padStart(2, '0')}`,
          orderNo: `ORD${1000 + i}`,
          book: `ì‚°ì—…ì•ˆì „ êµì¬ ${i + 1}`,
          amount: `${12000 + i * 500}ì›`,
          storeOrder: `BOOK${200 + i}`,
          courier: "CJëŒ€í•œí†µìš´",
          tracking: `12345${i}`,
          status: i % 2 === 0 ? "ë°°ì†¡ì™„ë£Œ" : "ë°°ì†¡ì¤‘",
          payDate: `2025-09-${String(5 + i).padStart(2, '0')}`,
          deliveryMethod: i % 2 === 0 ? "íƒë°°" : "ì§ì ‘ìˆ˜ë ¹",
        })).sort((a, b) => new Date(b.orderDate) - new Date(a.orderDate));


        // âœ… ëª¨ë‹¬ ì œì–´
        const modalOverlay = document.getElementById("modalOverlay");
        const modalTitle = document.getElementById("modalTitle");
        const modalContent = document.getElementById("modalContent");
        const saveBtn = document.getElementById("saveBtn");
        const closeBtn = document.getElementById("closeBtn");

        function closeModal() {
          // ìˆ˜ì • ëª¨ë“œ í•´ì œ
          document.querySelectorAll(".editable").forEach((td) => {
            td.contentEditable = "false";
            td.classList.remove("bg-yellow-50", "border-2", "border-yellow-400");
          });
          saveBtn.classList.add("hidden");
          modalOverlay.classList.add("hidden");
        }

        closeBtn.addEventListener("click", closeModal);
        
        // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
        modalOverlay.addEventListener("click", (e) => {
          if (e.target === modalOverlay) {
            closeModal();
          }
        });

        function openModal(title, data, editable = false) {
          modalTitle.textContent = title;
          modalContent.innerHTML = `
          <div class='bg-blue-50 rounded-lg p-4 border border-blue-200'>
          <table class='w-full border-collapse text-sm'>
            <tbody>
              ${Object.entries(data)
              .map(
                ([key, val]) => `
                  <tr class='border-b border-blue-100'>
                    <td class='p-3 bg-blue-400 text-white font-semibold w-36 rounded-l'>${key}</td>
                    <td class='p-3 bg-white ${editable ? "editable" : ""}' contenteditable="false">${val}</td>
                </tr>`
              )
              .join("")}
            </tbody>
          </table>
          </div>
          ${editable
              ? `<div class='flex justify-end mt-4'>
                  <button id='editBtn' class='bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition'>ìˆ˜ì •í•˜ê¸°</button>
                </div>`
              : ""
            }
        `;
          modalOverlay.classList.remove("hidden");
          if (editable) {
            const editBtn = document.getElementById("editBtn");
            editBtn.addEventListener("click", () => {
              document.querySelectorAll(".editable").forEach((td) => {
                td.contentEditable = "true";
                td.classList.add("bg-yellow-50", "border-2", "border-yellow-400");
              });
              saveBtn.classList.remove("hidden");
              editBtn.classList.add("hidden");
            });
          }
        }

        document.getElementById("menuUserInfo").addEventListener("click", () => {
          openModal("íšŒì› ì •ë³´", memberData, true);
        });

        document.getElementById("menuDeliveryInfo").addEventListener("click", () => {
          openModal("ë°°ì†¡ì§€ ì •ë³´", deliveryData, true);
        });

        document.getElementById("menuAdminSite").addEventListener("click", () => {
          alert("ê´€ë¦¬ì ì‚¬ì´íŠ¸ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
        });

        document.getElementById("menuUserSite").addEventListener("click", () => {
          alert("í•™ìŠµì ì‚¬ì´íŠ¸ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
        });

        saveBtn.onclick = () => {
          alert("âœ… ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
          closeModal();
        };

        // 3ï¸âƒ£ --- í…Œì´ë¸” ë Œë”ë§ (ìƒë‹´ì´ë ¥, í•™ìŠµê´€ë¦¬, ë°°ì†¡ê´€ë¦¬) ---
        const historyBody = document.getElementById("history-body");
        if (historyData.length === 0) {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td colspan="7" class="text-center p-4 text-gray-500">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td>`;
          historyBody.appendChild(tr);
        } else {
          historyData.forEach((h) => {
            const tr = document.createElement("tr");
            tr.className = "border-b hover:bg-blue-50 cursor-pointer";
            tr.innerHTML = `
        <td class="p-3">${h.channel}</td>
        <td class="p-3">${h.categoryMain}</td>
        <td class="p-3">${h.categorySub}</td>
        <td class="p-3">${h.date}</td>
        <td class="p-3">${h.title}</td>
        <td class="p-3 font-semibold ${h.status === "ì²˜ë¦¬ì™„ë£Œ" ? "text-green-600" : "text-red-600"}">${h.status}</td>
        <td class="p-3">${h.manager}</td>`;
            historyBody.appendChild(tr);
          });
        }

        // âœ… ìƒë‹´ì´ë ¥ ë”ë³´ê¸° ë²„íŠ¼ í‘œì‹œ
        const historyMore = document.getElementById("history-more");

        if (historyData.length > 5) {
          historyMore.classList.remove("hidden");
        }

        let shownCount = 5;
        function renderHistory(limit) {
          historyBody.innerHTML = "";
          historyData
            .slice(0, limit)
            .forEach((h) => {
              const tr = document.createElement("tr");
              tr.className = "border-b hover:bg-blue-50 cursor-pointer";
              tr.innerHTML = `
        <td class="p-3">${h.datetime}</td>
        <td class="p-3">${h.channel}</td>
        <td class="p-3">${h.title}</td>
        <td class="p-3 font-semibold ${h.status === "ì²˜ë¦¬ì™„ë£Œ" ? "text-green-600" : "text-red-600"}">${h.status}</td>
        <td class="p-3">${h.manager}</td>`;
              historyBody.appendChild(tr);
            });
        }


        // ì²˜ìŒ 5ê°œë§Œ ë Œë”ë§
        renderHistory(shownCount);

        // ë”ë³´ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ 5ê°œì”© ì¶”ê°€ í‘œì‹œ
        historyMore.addEventListener("click", () => {
          shownCount += 5;
          renderHistory(shownCount);
          if (shownCount >= historyData.length) {
            historyMore.classList.add("hidden");
          }
        });


        // âœ… ìƒë‹´ í´ë¦­ ì‹œ ìƒì„¸ ì •ë³´ í‘œì‹œ (ì„ íƒí–‰ í•˜ì´ë¼ì´íŠ¸ í¬í•¨)
        const historyDetail = document.getElementById("history-detail");

        historyBody.addEventListener("click", (e) => {
          const row = e.target.closest("tr");
          if (!row) return;

          // ğŸ”¹ ê¸°ì¡´ ì„ íƒëœ í–‰ ìƒ‰ìƒ ì´ˆê¸°í™”
          Array.from(historyBody.querySelectorAll("tr")).forEach((r) =>
            r.classList.remove("bg-blue-100")
          );

          // ğŸ”¹ í˜„ì¬ í´ë¦­ëœ í–‰ë§Œ í•˜ì´ë¼ì´íŠ¸
          row.classList.add("bg-blue-100");

          // ğŸ”¹ ì„ íƒëœ ë°ì´í„° ì°¾ê¸°
          const index = Array.from(historyBody.children).indexOf(row);
          const h = historyData[index];
          if (!h) return;

          // ğŸ”¹ ìƒì„¸ë‚´ìš© í‘œì‹œ
          historyDetail.classList.remove("hidden");
          historyDetail.innerHTML = `
            <h4 class="font-semibold text-blue-700 text-md mb-3">${h.title}</h4>
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-4">
              <table class="w-full border-separate border-spacing-y-2 text-sm">
                <tbody>
                  <tr>
                    <td class="p-2 bg-gray-50 w-32 font-semibold rounded-l-lg">ìƒë‹´ì±„ë„</td>
                    <td class="p-2 rounded-r-lg border border-gray-100">${h.channel}</td>
                  </tr>
                  <tr>
                    <td class="p-2 bg-gray-50 font-semibold rounded-l-lg">ëŒ€ë¶„ë¥˜</td>
                    <td class="p-2 rounded-r-lg border border-gray-100">${h.categoryMain}</td>
                  </tr>
                  <tr>
                    <td class="p-2 bg-gray-50 font-semibold rounded-l-lg">ì¤‘ë¶„ë¥˜</td>
                    <td class="p-2 rounded-r-lg border border-gray-100">${h.categorySub}</td>
                  </tr>
                  <tr>
                    <td class="p-2 bg-gray-50 font-semibold rounded-l-lg">ìƒë‹´ì¼ì‹œ</td>
                    <td class="p-2 rounded-r-lg border border-gray-100">${h.datetime}</td>
                  </tr>
                  <tr>
                    <td class="p-2 bg-gray-50 font-semibold rounded-l-lg">ë‹´ë‹¹ì</td>
                    <td class="p-2 rounded-r-lg border border-gray-100">${h.manager}</td>
                  </tr>
                  <tr>
                    <td class="p-2 bg-gray-50 font-semibold rounded-l-lg">ì§„í–‰ìƒíƒœ</td>
                    <td class="p-2 rounded-r-lg border border-gray-100">${h.status}</td>
                  </tr>
                  <tr>
                    <td class="p-2 bg-gray-50 font-semibold rounded-l-lg">ë‹µë³€ë‚´ìš©</td>
                    <td class="p-2 rounded-r-lg border border-gray-100 whitespace-pre-wrap text-gray-700">${h.detail?.reply || "ë‚´ìš© ì—†ìŒ"}</td>
                  </tr>
                </tbody>
              </table>
            </div>
            `;
        }); 


        const studyBody = document.getElementById("study-body");
        const studyMore = document.getElementById("study-more");

        if (studyData.length > 5) {
          studyMore.classList.remove("hidden");
        }

        let studyShown = 5;
        function renderStudy(limit) {
          studyBody.innerHTML = "";
          if (studyData.length === 0) {
            document.getElementById("study-empty").classList.remove("hidden");
            return;
          }
          studyData
            .slice(0, limit)
            .forEach((s) => {
              const tr = document.createElement("tr");
              tr.className = "border-b hover:bg-blue-50";
              tr.innerHTML = `
        <td class="p-3">${s.round}</td>
        <td class="p-3">${s.code}</td>
        <td class="p-3">${s.subject}</td>
        <td class="p-3">${s.period}</td>
        <td class="p-3">${s.reviewPeriod}</td>
        <td class="p-3">${s.attend}</td>
        <td class="p-3">${s.test}</td>
        <td class="p-3">${s.mock}</td>
        <td class="p-3">${s.reset}</td>
        <td class="p-3">${s.level}</td>
        <td class="p-3">${s.grade}</td>
        <td class="p-3">${s.complete}</td>
        <td class="p-3">${s.baseScore}</td>
        <td class="p-3">${s.provider}</td>
        <td class="p-3">${s.regDate}</td>`;
              studyBody.appendChild(tr);
            });
        }

        // âœ… ì²˜ìŒ 5ê°œë§Œ ë Œë”ë§
        renderStudy(studyShown);

        // âœ… ë”ë³´ê¸° í´ë¦­ ì‹œ 5ê°œì”© ì¶”ê°€ í‘œì‹œ
        studyMore.addEventListener("click", () => {
          studyShown += 5;
          renderStudy(studyShown);
          if (studyShown >= studyData.length) {
            studyMore.classList.add("hidden");
          }
        });


        // âœ… ë°°ì†¡ê´€ë¦¬ í‘œì‹œ (ìµœê·¼ 5ê°œë§Œ + ë”ë³´ê¸°)
        const deliveryBody2 = document.getElementById("delivery-body");
        const deliveryMore = document.getElementById("delivery-more");
        const deliveryEmpty = document.getElementById("delivery-empty");

        if (newDeliveryData.length === 0) {
          deliveryEmpty.classList.remove("hidden");
        } else {
          let deliveryShown = 5;

          function renderDelivery(limit) {
            deliveryBody2.innerHTML = "";
            newDeliveryData.slice(0, limit).forEach((d) => {
              const tr = document.createElement("tr");
              tr.className = "border-b hover:bg-blue-50";
              tr.innerHTML = `
        <td class="p-3 whitespace-nowrap">${d.orderDate}</td>
        <td class="p-3 whitespace-nowrap">${d.orderNo}</td>
        <td class="p-3 whitespace-nowrap">${d.book}</td>
        <td class="p-3 whitespace-nowrap">${d.amount}</td>
        <td class="p-3 whitespace-nowrap">${d.storeOrder}</td>
        <td class="p-3 whitespace-nowrap">${d.courier}</td>
        <td class="p-3 whitespace-nowrap">${d.tracking}</td>
        <td class="p-3 whitespace-nowrap">${d.status}</td>
        <td class="p-3 whitespace-nowrap">${d.payDate}</td>
        <td class="p-3 whitespace-nowrap">${d.deliveryMethod}</td>`;
              deliveryBody2.appendChild(tr);
            });
          }

          // âœ… ì´ˆê¸° ë Œë”ë§
          renderDelivery(deliveryShown);

          // âœ… 5ê°œ ì´ˆê³¼ë©´ ë”ë³´ê¸° ë²„íŠ¼ í‘œì‹œ
          if (newDeliveryData.length > 5) {
            deliveryMore.classList.remove("hidden");
          }

          // âœ… ë”ë³´ê¸° í´ë¦­ ì‹œ 5ê°œì”© ì¶”ê°€
          deliveryMore.addEventListener("click", () => {
            deliveryShown += 5;
            renderDelivery(deliveryShown);
            if (deliveryShown >= newDeliveryData.length) {
              deliveryMore.classList.add("hidden");
            }
          });
        }
      </script>
</body>

</html>